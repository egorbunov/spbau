\documentclass[12pt, a4paper]{article}

\usepackage[no-math]{fontspec}
\usepackage[main = russian, english]{babel}
\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage[top=0.5in, bottom=0.7in, left=0.6in, right=0.6in]{geometry}

% ========= MATH stuff packages ===========

\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}

\usepackage[sc]{mathpazo}
\usepackage[euler-digits,euler-hat-accent]{eulervm}

\usepackage{MnSymbol} % order is crucial

% ============= TEXT FONT ================

\defaultfontfeatures{Mapping=tex-text, Scale=MatchLowercase}

% \setmainfont[
%  BoldFont={PTSansPro-Bold}, 
%  ItalicFont={PTSansPro-Italic},
%  BoldItalicFont={PTSansPro-BoldItalic}
% ]{PTSansPro-Regular}

% \setmainfont[
%  BoldFont={PFRegalTextPro-Bold}, 
%  ItalicFont={PFRegalTextPro-RegularAItalic},
%  BoldItalicFont={PFRegalTextPro-BoldItalic}
% ]{PFRegalTextPro-RegularB}

\setmainfont[
 BoldFont={GretaTextPro-Bold}, 
 ItalicFont={GretaTextPro-Italic},
 BoldItalicFont={GretaTextPro-BoldItalic}
]{GretaTextPro-Light}

% \setmainfont[
%  BoldFont={PFHandbookPro-Bold}, 
%  ItalicFont={PFHandbookPro-Italic},
%  BoldItalicFont={PFHandbookPro-BoldItalic}
% ]{PFHandbookPro-Regular}

% \setmainfont[
%  BoldFont={PermianSerifTypeface-Bold}, 
%  ItalicFont={PermianSerifTypeface-Italic},
%  % BoldItalicFont={PermianSerifTypeface-BoldItalic}
% ]{PermianSerifTypeface-Regular}

% \setmainfont[
%  BoldFont={CelestePro-Bold}, 
%  ItalicFont={CelestePro-Ita},
%  BoldItalicFont={CelestePro-BoldIta}
% ]{CelestePro}

% \setmainfont{Pragmatica Slabserif}

% \setmonofont[Mapping=tex-text]{Liberation Mono}


\usepackage{parskip}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage[shortlabels]{enumitem}

% ========= Graph stuff packages ==========
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{subfig}
\usepackage{tikz}
\usepackage{tkz-berge}

% ========= Special packages ==============
\usepackage{bussproofs}
\usepackage{stmaryrd}

% ========= Listings / algo packages =========
\usepackage{xifthen}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{listings}

\lstset{
  frame=none,
  xleftmargin=2pt,
  stepnumber=1,
  numbers=left,
  numbersep=5pt,
  numberstyle=\ttfamily\tiny\color[gray]{0.3},
  belowcaptionskip=\bigskipamount,
  captionpos=b,
  escapeinside={*'}{'*},
  language=python,
  tabsize=2,
  emphstyle={\bf},
  commentstyle=\it,
  stringstyle=\mdseries\rmfamily,
  showspaces=false,
  keywordstyle=\bfseries\rmfamily,
  columns=flexible,
  basicstyle=\small\sffamily,
  showstringspaces=false,
  morecomment=[l]\%,
}

\usetikzlibrary{shapes,snakes}
\usetikzlibrary{arrows, petri, topaths}
\linespread{1.3}
\setlist[enumerate, 1]{label = (\alph*)}


\newenvironment{task}[1][]
{
	\par\medskip
	\noindent \textbf{Задание~№#1}
	\rmfamily
}
{
}

\newenvironment{solution}[1][]
{
	\par
	\noindent \textbf{\textit{Решение:~}}
	\rmfamily
}
{
	\medskip
}

% Math and algorithms
\makeatletter
\renewcommand{\ALG@name}{Алгоритм}
\renewcommand{\listalgorithmname}{Список алгроитмов}
\newenvironment{procedure}[1]
  {\renewcommand*{\ALG@name}{Процедура}
  \algorithm\renewcommand{\thealgorithm}{\thechapter.\arabic{algorithm} #1}}
  {\endalgorithm}
\makeatother

\algrenewcommand\algorithmicrequire{\textbf{Вход:}}
\algrenewcommand\algorithmicensure{\textbf{Выход:}}
\algnewcommand\True{\textbf{true}\space}
\algnewcommand\False{\textbf{false}\space}
\algnewcommand\And{\textbf{and}\space}
\newcommand{\xfor}[3]{#1 \textbf{from} #2 \textbf{to} #3}
\newcommand{\xassign}[2]{\State #1 $\leftarrow$ #2}
\newcommand{\xstate}[1]{\State #1}
\newcommand{\xreturn}[1]{\xstate{\textbf{return} #1}}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\newcommand{\bigO}[1]{\mathcal{O}\left(#1\right)}
\newcommand{\xqed}{\hfill $\blacksquare$}
\newcommand{\code}[1]{\colorbox{gray!15}{\footnotesize\texttt{#1}}}

% Commands (my)

\newcommand{\xparen}[1]{\left( #1 \right)}
\newcommand{\xangel}[1]{\left\langle #1 \right\rangle}
\newcommand{\xbrack}[1]{\left[ #1 \right]}
\newcommand{\xbrace}[1]{\left\lbrace #1 \right\rbrace}
\newcommand{\xret}[0]{\rightarrow}
\newcommand{\xintrp}[1]{\left\llbracket #1 \right\rrbracket}

