%!TEX program = xelatex

\input{env.tex}
\title{Домашнее задание №10 \\ Алгоритмы. 5 курс. Весенний семестр.}
\author{Горбунов Егор Алексеевич}

\begin{document}
\maketitle
\begin{task}[1]
Докажите, что в регулярном двудольном графе есть полное паросочетание.
\end{task}
\begin{solution}
Пускай доли графа $G$ --- это $A$ и $B$, а степень каждой вершины равна $d$.
\begin{enumerate}[label=\arabic*.]
\item Покажем, что существует $A$-насыщенное паросочетание в $G$ (такое паросочетание, которое покрывает всё множество $A$). Рассмотрим $X \subset A$. Предположим, что $|N(X)| < |X|$ (обозначения как в теореме Холла), но т.к. $\forall v \in X\ deg(v) = d$, то суммарно в $N(X)$ входит $|X|\cdot d$ рёбер. По обобщённому принципу Дирихле найдётся такая вершина $u \in N(X)$, что $deg(u) \geq \ceil{\frac{|X|\cdot d}{|N(X)|}} > d$, но у нас граф регулярный, а значит получено противоречие и для выбранного (произвольно) $X\ |N(X)| \geq |X|$, а значит выполнена теорема Холла и существует $A$-насыщенное паросочетание.
\item Абсолютно аналогично получаем, что существует $B$-насыщенное паросочетание и при этом из теоремы холла в первом и втором случае следует, что $|A| \leq |N(A)| \leq |B|$ и $|B| \leq |N(B)| \leq |A|$, а значит $|A| = |B|$. Таким образом получили, что $A$-насыщенное паросочетание является совершенным (полным), т.е. в регулярном графе $G$ существует полное паросочетание. \xqed
\end{enumerate}
\end{solution}

\begin{task}[2]
Для заданного клетчатого поля с дырками выберите максимальное количество попарно не смежных клеток. 
Смежными считаются клетки с общей стороной.
\end{task}
\begin{solution}
Раскрасим клетки доски в шахматном порядке (на дырки краска не ложится) в чёрный и белый цвета. Заметим, что чёрные попарно не смежны и белые клетки попарно не смежны тоже. Теперь сконструируем граф: каждой клетке доски соответствует вершина, вершина соединена рёбрами со смежными ей клетками. Ясно, что такой граф то будет двудольным, причём в первой доле будут чёрные клетки, а во второй белые. По теореме Кёнига знаем, что размер максимального независимого множества вершин двудольного графа (а оно то нас и интересует, ибо в данном случае это будет максимальное множество попарно несмежных клеток) равен размеру максимального паросочетания. Ну вот, теперь просто найдём максимальное паросочетания в двудольном графе известным нам алгоритмом. \xqed 
\end{solution}

\begin{task}[4]
Разбейте вершины ориентированного графа на циклы. Т.е. каждая вершина должна быть покрыта ровно одним циклом. Либо скажите, что это невозможно.
\end{task}
\begin{solution}
Давайте заметим такую вещь, что если каждой вершине $v$ поставлено в соответствие ребро $e_{in}^v$, входящее в $v$ и ребро $e_{out}^v$ исходящее из $v$, причём существует вершина $x$, что $e_{in}^v$ для неё является $e_{out}^x$ и существует вершина $y$, что $e_{out}^v$ для неё является $e_{in}^y$, тогда мы получим разбиение исходного графа на циклы (т.е. каждой вершине сопоставим какой-то цикл). Действительно, пускай такое соответствие задано, тогда:
\begin{algorithmic}
\xassign{$M$}{$0$}
\For{$v \in V$}
	\If{$mark[v] > 0$}
		\xstate{$continue$}
	\EndIf
	\xassign{$M$}{$M+1$}
	\xassign{$cur$}{$v$}
	\While{$mark[cur] < 0$}
		\xassign{$mark[cur]$}{$M$}
		\xassign{$cur$}{$e_{out}^{cur}.to$}
	\EndWhile
\EndFor
\end{algorithmic}
Тут условие в цикле $mark[cur]<0$ эквивалентно тому, что мы пришли обратно в $v$.

Теперь научимся находить такое соответствие вершин и рёбер. Построим двудольный граф с долями $X$ и $Y$, причём в $X$ будет $|V|$ вершин и в $Y$ будет $|V|$ вершин. Если $v \in V$, то $v_{from} \in X$ и $v_{to} \in Y$. Если же в исходном графе есть дуга $(v, u)$, то в двудольном графе есть ребро $\xbrace{v_{from}, u_{to}}$. Заметим теперь, что если в этом двудольном графе есть совершенное паросочетание, то мы нашли, описанное выше, соответствие и разбили граф на циклы, т.к. совершенному (в силу его совершенности) паросочетанию будут принадлежать какие-то рёбра $\xbrace{v_{from}, a_{to}}$ и $\xbrace{b_{from}, v_{to}}$, что означает, что в соответствие вершине $v$ поставлены дуги $(v, a)$ и $(b, v)$.
\xqed 
\end{solution}

\begin{task}[5]
Дано $N$ различных прямых. Нужно выбрать максимальное по размеру подмножество прямых
такое, что никакие две прямые не параллельны, и никакие прямые не пересекаются в точке c
$x = 0$.
\end{task}
\begin{solution}
Считаем, что все прямые заданы тройкой чисел ($v$, $k$, $b$), причём если прямая вертикальная, т.е. параллельна оси ординат, то $v = true$, а $k$ равно её смещению по оси абсцисс, а если $v = false$, то $k$ и $b$ задают прямую обычным образом: $y = kx + b$. Таким образом можно легко сформулировать условия, при которых две линии параллельны или пересекаются в точке с $x = 0$ (эти совсем простые проверки не указываю за ненадобностью).

Теперь возьмём и каждой прямой сопоставим по вершине и получим тем самым множество вершин $X$. Продублируем это множество и получим множество вершин $Y$, каждая из которых так же соответствует какой-то линии. Теперь вершину $v$ соединим ребром с вершиной из $u$, если линия, соответствующая $v$ параллельна или пересекается в $x = 0$ с линией, соответствующей $u$. Получили двудольный граф. Умеем искать паросочетание максимального размера в нём, но по теореме Кёнига размер максимального паросочетания равен размеру наибольшего независимого множества, которое по условию задачи от нас и требуется. Искать наибольшее независимое множество так же умеем...\xqed
\end{solution}
\end{document}