\input{env.tex}
\title{Домашнее задание №5 \\ Алгоритмы. 5 курс. Весенний семестр.}
\author{Горбунов Егор Алексеевич}

\begin{document}
\maketitle

\begin{task}[1]
Дана матрица $A$ размера $n \times m$. Найти такое представление $A = B \cdot C$, что $B$ имеет размер $n \times k$
и $k$ минимально.
\end{task}
\begin{solution} Пусть у нас есть какое-то разложение $A = B \cdot C$, что размер $B$ равен $n \times k$, а размер $C$, соответственно $k \times m$. Известно тогда, что $rang(A) \leqslant rang(B)$ и $rang(A) \leqslant rang(C)$, но тогда имеем:
\[
	rang(A) \leqslant rang(B) \leqslant \min{(n, k)} \Rightarrow rang(A) \leqslant k
\]
Таким образом, самым минимальным возможным $k$ может быть $rang(A)$ --- ранг исходной матрицы. Покажем, что этот минимально возможный $k$ достигается.

Обозначим ранг матрицы $A$ за $r$ и выберем, соответственно, $r$ линейно независимых стобцов матрицы $A$. Не умаляя общности считаем, что это первые $r$ стобцов матрицы.
\[
	A = \left[ \bm{a_1}, \bm{a_2}, \ldots, \bm{a_r}, \bm{a_{r+1}}, \bm{a_{r+2}}, ..., \bm{a_{m}} \right]
\]
Знаем, что любой столбец матрицы $A$ выражается через $a_1, a_2, \ldots, a_r$ линейной комбинацией, т.е:
\[
	\bm{a_j} = \bm{a_1} \cdot c_{1j} + \bm{a_2} \cdot c_{2j} + \bm{a_3} \cdot c_{3j} + \ldots + \bm{a_r} \cdot c_{rj}
\]
Или раскрывая:
\begin{equation}
\label{eq:t1}
	\begin{pmatrix}
		a_{1j}\\
		a_{2j}\\
		\vdots\\
		a_{nj} 
	\end{pmatrix}
	=
	\begin{pmatrix}
		a_{11}c_{1j} + a_{12}c_{2j} + \ldots a_{1r}c_{rj}\\
		a_{21}c_{1j} + a_{22}c_{2j} + \ldots a_{2r}c_{rj}\\
		\vdots\\
		a_{n1}c_{1j} + a_{n2}c_{2j} + \ldots a_{nr}c_{rj}

	\end{pmatrix}
\end{equation}
Ясно теперь, что если взять:
\[
	B = \left[ \bm{a_1}, \bm{a_2}, \ldots, \bm{a_r} \right],\ C = 
	\begin{pmatrix}
		1 & 0 & \ldots 0 & c_{1,{r + 1}} & \ldots & c_{1n} \\
		0 & 1 & \ldots 0 & c_{2,r + 1} & \ldots & c_{2n} \\
		\ldots \\
		0 & 0 & \ldots 1 & c_{r,r + 1} & \ldots & c_{rn}
	\end{pmatrix}
\]
То получим искомое разложение. Находить коэффициенты $c_{ij}$ можно, например, решая системы линейных уравнений~\ref{eq:t1} для каждого столбца известными методами.
\xqed
\end{solution}

\begin{task}[2]
Для заданного $n$ и простого $p$ найти число таких $k \in [0, n]$, что ${n \choose k} \mod{p} = 0$
Можно считать, что все операции по модулю p происходят за $\bigO{1}$. Придумайте алгоритм, который работает за:
	\begin{enumerate}[label=(\alph*)]
		\item $\bigO{n}$
		\item $\bigO{poly{(\log{n})}}$
	\end{enumerate}
\end{task}
\begin{solution}

\begin{enumerate}[label=(\alph*)]
	\item Запишем биномиальный коэффициент: 
	\[ 
		{n \choose k} = \frac{n\cdot(n-1)\cdot(n-2)\cdot \ldots \cdot (n-k+1)}{1\cdot2\cdot\ldots\cdot(k-2)\cdot(k-1)\cdot k}
	\]
\end{enumerate}
Будем поддерживать степень, в которой входит $p$ в числитель и знаменатель, последовательно перебирая все биномиальные коэффициенты:
\[
	\frac{n}{1},\ \frac{n\cdot(n-1)}{1\cdot2},\ \frac{n\cdot(n-1)\cdot(n-2)}{1\cdot2\cdot3}, \ldots
\]
Если мы знаем степень, в которой $p$ входит в числитель и знаменатель, то можем сказать, делится ли на $p$ биномиальный коэффициент просто посмотрев на разность этих степеней.
Т.е. вначале мы должны знать степень, в которой $p$ входит в $n$ для числителя и в $1$ для знаменателя. И так далее. Пусть на $i$-ом шаге мы знаем степень $d^1_i$, в которой $p$ входит в числитель $n\cdot(n-1)\cdot\ldots\cdot(n-i+1)$ и в степень $d^2_i$, в которой $p$ входит в знаменатель $1\cdot2\cdot\ldots \cdot i$. Тогда на следующем шаге они пересчитываются так: $d^1_{i+1} = d^1_i + degree_p(n - i)$, $d^2_{i+1} = d^2_i + degree_p(i + 1)$, где $degree_p(x)$ --- степень, в которой $p$ входит в $x$ (тут в дело вступает простота $p$). Чтобы суммарно это дело работало за $\bigO{n}$ нам нужно уметь быстро находить $degree_p(x)$ для $x \in [1, n]$. Как? Предподсчитаем его за $\bigO{n}$ так:
\[
	\begin{array}{lcl}
		degree_p(p)  & = & 1\\
		\ldots\\
		degree_p((p-1)p) & = & 1\\
		degree_p(p^2 + p) & = & 1 \\
		\ldots\\
		degree_p(p^2) & = & 2 \\
		degree_p(2p^2) & = & 2 \\
		\ldots\\
		degree_p(p^3 + p^2) & = & 2\\
		\ldots
		degree_p(p^3) & = & 3\\
		\ldots
	\end{array}
\] 
Такю процедуру точно можно за линию организовать, посчитав степени $p$, пока они меньше $n$ и далее рекурсивно это дело строить...
\xqed
\end{solution}

\begin{task}[3]
На кольцевой стоят $n$ светофоров и хитро перемигиваются. Свет на каждом светофоре зажигается в таком порядке: зеленый-желтый-красный, снова зеленый и так по кругу. Все светофоры пронумерованны от $1$ до $n$. Если светофор по номеру $i$ решит поменять свой цвет то следующие, $k_i$ светофоров с шагом $a_i$ тоже поменяют свой цвет. Ниже приведен пример, когда переключается первый светофор: $k_1 = 6, a_1 = 2$. 

По начальному состоянию светофоров определите, возможен ли зеленый коридор. Т.е. такая ситуация, когда все светофоры переключены на зеленый. Решить за $\bigO{n^3}$.
\end{task}
\begin{solution}
Делаем все операции по модулю $3$ --- число состояний светофора.

Начальное состояние светофоров $s = \xparen{s_1, s_2, \ldots, s_n}^T \in \xbrace{0,1,2}^n$. Построим матрицу $A$ нал $\xbrace{0, 1}$, что если $A_{ij} = 1$, то светофор $j$ провоцирует смену цвета светофора $i$. Эту матрицу заплним так:
\begin{align*}
	A_{ii} &= 1,\ \forall i\\
	A_{k\cdot a_i, i} &= 1,\ \forall i,\ k \in \xbrace{1, 2, \ldots, k_i}
\end{align*}
Пускай теперь у нас в векторе $\xparen{c_1, c_2, \ldots, c_n}$ записаны количества переключений $i$-го светофора, т.е. светофор $i$ сам переключался $c_i$ раз. Посмотрим на такое произведение (для примера взято $n = 3$): 
\[
	\begin{pmatrix}
		s_1\\
		s_2\\
		s_3
	\end{pmatrix} 
	\begin{pmatrix}
		a_{11} & a_{12} & a_{13} \\
		a_{21} & a_{22} & a_{23} \\
		a_{31} & a_{32} & a_{33} \\
	\end{pmatrix}
	\times
	\begin{pmatrix}
		c_1\\
		c_2\\
		c_3
	\end{pmatrix}
	=
	\begin{pmatrix}
		s_1 + a_{11}c_1 + a_{12}c_2 + a_{13}c_3\\
		s_2 + a_{21}c_1 + a_{22}c_2 + a_{23}c_3\\
		s_3 + a_{31}c_1 + a_{32}c_2 + a_{33}c_3
	\end{pmatrix}
\]
Заметим, что в $i$-ом элементе результирующего вектора записано состояние $i$-го светоформа после того, как каждый светофор переключился своё число раз (заданное вектором $c$). Это действительно так, ибо каждое слагаемое $a_{ij}c_j$ равно $c_j$, если переключение $j$ провоцирует переключение $i$, т.е. на каждое переключение $j$ имеем переключение $i$ и $0$, если $a_{ij} = 0$, так же учитывается начальное состояние $s_i$. 

Таким образом мы умеем находить конечное состояние светофоров, при помощи произведения матриц, по исходному состоянию и значениям $k_i, a_i$ и числу самостоятельных переключений каждого светоформа:
\[
	\bm{s} + A\cdot\bm{c} = \bm{x}
\]
Зелёный коридор --- это когда $\bm{x} = \bm{0}$. А значит, чтобы понять, возможен ли зелёный коридор, нужно проверить, имеет ли решения СЛАУ:
\[
	A\cdot\bm{c} = -\bm{s}
\]
Это делается как раз за $\bigO{n^3}$. \xqed
\end{solution}

\end{document}
