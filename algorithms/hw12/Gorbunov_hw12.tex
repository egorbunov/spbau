%!TEX program = xelatex

\input{env.tex}
\title{Домашнее задание №12 \\ Алгоритмы. 5 курс. Весенний семестр.}
\author{Горбунов Егор Алексеевич}

\begin{document}
\maketitle

\begin{task}[1]
Найти подстроку в тексте. При сравнении строк можно делать циклический сдвиг алфавита в одной из них. $\bigO{n + m}$, алфавит --- не константа.
\end{task}
\begin{solution}
У нас алфавит конечный, пусть всем буквам сопоставлено целое число в соответствие. Теперь заметим, что если строка $c_1c_2\ldots c_l$ равна с точностью до сдвига алфавита строке $c'_1c'_2\ldots c'_l$, то это значит, что равны следующие массивы (строки):
\[
	(c_2 - c_1), (c_3 - c_2), \ldots, (c_k - c_{k-1}) \text{ и } (c'_2 - c'_1), (c'_3 - c'_2), \ldots, (c'_k - c'_{k-1})
\]
Разности соседних элементов не меняются при сдвиге алфавита.
Такие массивы по сути тоже строки, поэтому мы можем применять к ним тот же аппарат, что применяем к строкам.

Итак. Данные на вход строку и текст мы переделаем в массивы разностей, после чего будем использовать, например, алгоритм Кнута-Морриса-Пратта, что даст нам асимптотику в $\bigO{n + m}$. 
\end{solution}


\begin{task}[2]
Для каждого префикса строки найти количество его префиксов равных его суффиксу. $\bigO{n}$
\end{task}


\begin{task}[3]
Преобразовать $Z$-функцию в префикс-функцию без промежуточного восстановления строки за $\bigO{n}$
\end{task}


\begin{task}[5]
Даны бор $A$ и строка $s$. Нужно вернуть вершину бора $v$, от которой строку $s$ можно отложить вниз. Размер алфавита $\bigO{1}$. Время $\bigO{|A|+|s|)}$.
\end{task}

\begin{task}[6]
В словаре могут добавляться и удаляться слова. Необходимо в $online$ научиться отвечать на запрос $get(t)$ вида <<входит ли в текст $t$ хоть одно словарное слово>>. Амортизированное время работы $add(s)$ и $del(s)$: $\bigO{|s|\log{L}}$, время работы $get(t): \bigO{|t|\log{L}}$ ($L$ --- суммарная длина всего). Подсказка: заведите порядка $\log{L}$ боров.
\end{task}


\begin{task}[7]
Дан набор слов. Придумать самую короткую строку, допускающую более одного разбиения на словарные слова или сообщить, что такой нет. Время работы --- полином от суммы длин слов и размера алфавита.
\end{task}

\end{document}