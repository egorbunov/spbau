\input{env.tex}
\title{Алгоритмы. Домашнее задание №7}
\author{Горбунов Егор Алексеевич}

\begin{document}
\maketitle

\task{Сильная ориентация графа}
\textit{Нужно ориентировать рёбра данного неориентированного графа $G(V,E)$ за $\bigO{|V|+|E|}$ так, чтобы получившийся граф был сильно связным.}\\
Из курса по дискретной математике нам известно, что неориентированный граф $G$ может быть сильно ориентирован тогда и
только тогда, когда он двусвязный, т.е. в $G$ нет точек сочленения. Искать точки сочленения в графе $G$ мы умеем за 
$\bigO{|V|+|E|}$ и первым делом запустим алгоритм поиска точек сочленения и в случае, если точки сочленения будут найдены, то сообщим о том, что данный граф $G$ не допускает сильной ориентации.\\
Далее будем считать, что граф $G$ не содержит точек сочленения, т.е. двусвязен, а значит допускает сильную ориентицаю
рёбре. Построим такую ориентацию рёбер:

\begin{algorithmic}
\Procedure{DFS}{$v$}
	\xstate{isUsed$[v]=true$}
	\For{$u \in \Gamma{(v)}$}
		\xstate{\Call{orientEdgeFromTo}{$v,u$}}
		\If{isUsed$[u]=false$}
			\xstate{\Call{DFS}{$u$}}
		\EndIf
	\EndFor
\EndProcedure
\end{algorithmic}
Вызов <<orientEdgeFromTo($v,u$)>> просто ориентирует ребро $\lbrace v, u \rbrace$ так: $(v,u)$, т.е. $v\rightarrow~u$.
Таким образом мы просто ориентируем все рёбра в порядке обхода в глубину от предка к сыну, а если встречаем обратное ребро, которое может вести из вершины $v$ к её предку, то ориентируем его от сына ($v$) к предку.\\
Этот алгоритм будет работать по следующим причинам: рассмотрим 2 любые вершины $v$ и $u$ графа $G'$, который 
есть ориентированный граф $G$ по процедуре, приведённой выше. Посмотрим на эти вершины в дереве, которое было построено поиском в глубину. Пускай $p$ --- это любой общий предок вершины $v$ и $u$ в этом дереве (он  может совпадать с $v$ или $u$).
Заметим теперь, что т.к. $G$ --- двусвязный, то нам известно (из того же курса дискретной математики), что \textbf{любые $2$ вершины $G$ лежат на одном цикле}, но 
это значит, что $p$ и $v$ лежат на некотором цикле. Ясно тогда, что найдётся такая вершина $x$, что в дереве, построенном обходом в глубину, $v$ будет предком $x$ ($x$ может совпадать с $v$) и из $x$ будет торчать обратное ребро
в $p$:

\begin{figure}[ht!]
\centering
\begin{tikzpicture}
\GraphInit[vstyle=Classic]
\tikzset{VertexStyle/.append style = {minimum size = 3pt}}
\tikzstyle{EdgeStyle}=[post]
\Vertex[Math,x=-0.5,y=-1.25]{v}
\Vertex[Math,x=2,y=-2.5]{u}
\Vertex[Math,x=0,y=0]{p}
\Vertex[Math,x=-1.5,y=-2]{x}
\Edge[style=dashed](p)(v)
\Edge[style=dashed](p)(u)
\Edge[style=dashed](v)(x)
\tikzset{EdgeStyle/.append style = {bend left}}
\Edge[color=red,style=dashed](x)(p)
\end{tikzpicture}
\end{figure}
Но тогда мы видим, что из $v$ можно пройти в $u$ так: $v \rightarrow \ldots \rightarrow x \rightarrow p \rightarrow \ldots \rightarrow u$. Таким образом мы показали, что для любых двух вершин $v$ и $u$ графа $G'$, который есть ориентация графа $G$ по приведённой процедуре, из $v$ существует путь по ориентированным рёбрам в $u$. А это значит, 
что граф $G'$ сильно ориентирован. \xqed

\task{xxx}
\end{document}