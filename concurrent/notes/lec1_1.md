# Лекция 1

## Параллелизм на одном процессоре

Основная мысли: векторизация

* SSE - Streaming SIMD Extensions. Набор дополнительных регистров и инстуркций, использующихся для пакетной работы с числами. В версии `4.2` были добавлены операции со строками (XML тут как-то причём)
* MMX - Multi Media Extensions - работа с целыми числами
* AUX

## Параллелизм на нескольких процессорах

* Многопоточность
* => GRID -> Cloud Computing

### Проблемы

* Синхронизация

### Закон Амдала

* Последовательный код (который нельзя распараллелить): рекурентные вычисления (каждая итерация зависит от предыдущей), ввод/вывод

При использовании нескольких процессоров нам приходится использовать примитивы синхронизации. Честный метод синхронизации (какой-нибудь мьютекс), будучи захваченным, порождает последовательный участок кода, т.е. ухудшает общую производительность.

* `a` -- доля последовательного кода, `p` -- число процессоров, тогда: `S = (1 / (a + (1 - a) / p)`


### Multithreading VS IPC

* Multithreading
    - (+) Быстрое переключение между потоками (TLB, Translation Lookaside Buffer)
    - (+) Проще!

* IPC
    - (+) Надёжность. SEGFAULT в процессе не убъёт всё приложение, а вот если в потоке произошёл SEGFAUT, то всё приложение падаетя
    - (+) Безопасность (если поток зохчет что-нибудь испортить, то он сможет. Это всё одно адресное пространство! А для процесса, как единицы, всё под защитой ядра)

### Потоки пользователя и Ядра

Пусть `N` -- число потоков пользователя, а `M` -- число потоков ядра.
Бывало поразному реализовано:

* N < M
* N = M (сейчас в основном)
* N > M 

### Интересные факты

* Многопоточность действительно стала многопоточностью в ядре линукс с версии `2.6`, где была использована `NPTL (Native Posixe Thread Library)`.
* Первый массовый компьютер с настоящей многопоточностью -- Pentium D (2005 год)

## Многопоточность и инструменты

* Java. Не нужно наследоваться от `Thread`, вы ведь его никак не улучшаете и не меняете его поведения! Имплементируйте `Runnable`.
* OpenMP (поддерживается `C++` и `Fortran` компиляторами)
* Boost C++
* Intel TBB (хорошо продуманная архитектура, высокоуровневый)
