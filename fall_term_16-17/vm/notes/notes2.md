Data flow analysis

* IADD => на стеке должно быть 2 интеджера 
* Кто такой локал?
* Неподвижные точки хранятся для каждого метода
* Неподвижная точка: индекс локала, позиция его на стеке, наименьший тип
* Базовый блок == метод
* Сборщик мусора; root set?
* Сборщик мусора будет долго работать на очень длинной цепочке последовательных инструкций? Для решения был придуман хак: интерпретатор байткода клал в стек-слот не только значение, но и его тип!? не ясно.

```java
int foo(boolean b) {
    int i;
    try {
        if (b) return 1;
        i = 2;
    } finally {
        if (b) i = 3;
    }
    return i;
}
```

Данная программа не верифицируется. Что в ней происходит?

1. Когда мы попадаем в `finally` блок, то `i` может быть не инициализирована, если `b == true`


### Caching and optimization?

* Какие вещи сложно сделать в СИ?
    - Назначить переменную в регистр (кэширование)
    - Диспетчеризация? 
* Вычисляемые джампы между методами реализуются через указатели на методы (позиция метода)
* Вычисляемые джампы внутри метода: computed label, computed goto; (можно хранить в массиве и прыгать динамично) (локальные переходы). 
* Нелокальный переходы: setjmp и longjmp (сохраняют не только IP, но и всякое другое)


Частые инструкции: load, store, арифметика (add sub)
Хорошая практика: 2 интерпретатора, один маленький для частых инструкций (маленький, т.к. мало маленьких инструкций) и один для не частых


### Locks

* Предвзятые локи (техника)
* Адаптивные мьютексы (спинлок + обычная блокировка после некоторого времени)

### Нативный интерфейс

* JNI
* KNI (? may be dead)
* CNI
* RNI

#### JNI

* Байткод Invoke Native который описывает имя функции, которую нужно дёрнуть
* JVM должна это имя как-то распарсить и найти среди доступных библиотек
* Неудобная херня (Я не понял почему)

Как реализовано? (передача аргументов и прочее)

* В Go идёт работа не с libc, а с syscalls
* В Java используются обёртки над glibc?

### Что сложно написать на Java?

* PS: дизайн оконных систем...почитай
* Можно написать (если запариться), наверное, всё
* Но не нужно. Т.е. ответ на вопрос это: всякие штуки близкие к ОС и железу (Ваш КО) 
